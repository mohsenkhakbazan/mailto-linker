<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mailto: Link Generator</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="styles.css?v=1" />
</head>
<body>
  <div class="shell">
    <header class="topbar">
      <div class="brand">
        <div class="logo">✉️</div>
        <div>
          <div class="title">Mailto: Link Generator</div>
          <div class="subtitle">This tool creates shareable links to a pre-filled email</div>
        </div>
      </div>
    </header>

    <main class="container">
      <div class="app">
        <section class="panel">
          <form id="form" class="form">
            <div class="grid">
              
              <div class="col">
                <div class="field">
                  <div class="labelrow">
                    <label for="to">To <span class="req">*</span></label>
                    <div class="meta"><span id="toCount">0</span>/100</div>
                  </div>
                  <textarea id="to" rows="4" placeholder="Paste email addresses here"></textarea>
                  <div class="hint">Separators: <code>,</code> <code>/</code> <code>;</code> <code>space</code> <code>newline</code></div>
                  <div id="toPreview" class="preview"></div>
                </div>

                <div class="field">
                  <div class="labelrow">
                    <label for="cc">CC</label>
                    <div class="meta"><span id="ccCount">0</span>/100</div>
                  </div>
                  <textarea id="cc" rows="3" placeholder="Optional"></textarea>
                  <div id="ccPreview" class="preview"></div>
                </div>
              </div>

              
              <div class="col">
                <div class="field">
                  <label for="subject">Subject</label>
                  <input id="subject" type="text" maxlength="200" placeholder="Optional (max 200 chars)" />
                </div>

                <div class="field">
                  <label for="ttl">Expiration</label>
                  <select id="ttl">
                    <option value="7">7 days</option>
                    <option value="30" selected>30 days</option>
                    <option value="90">90 days</option>
                  </select>
                  <div class="hint">Links are automatically deleted after expiration</div>
                </div>

                <div class="field">
                  <div class="callout">
                    <div class="calloutTitle">Tip</div>
                    <div class="calloutBody">
                      If a mail app doesn’t open in some in-app browsers, append <code>?landing=1</code> to the link
                    </div>
                  </div>
                </div>
              </div>

              
              <div class="col span2">
                <div class="field">
                  <label for="body">Body</label>
                  <textarea id="body" class="body" rows="12" placeholder="Email body (max 10,000 chars)"></textarea>
                </div>

                <div class="actions">
                  <button id="generateBtn" type="submit">Generate Link</button>
                  <span id="status" class="status"></span>
                </div>

                <div id="result" class="result hidden">
                  <div class="resultRow">
                    <input id="shortUrl" readonly />
                    <div class="copyWrap">
                      <div id="copiedBadge" class="copied-badge hidden">Copied!</div>
                      <button id="copyBtn" type="button" class="secondary">Copy</button>
                    </div>
                    <a id="openBtn" class="secondary linkbtn" href="#" target="_blank" rel="noreferrer">Open</a>
                  </div>
                </div>

                <div id="errorBox" class="error hidden"></div>
              </div>
            </div>
          </form>
        </section>
      </div>
    </main>
  </div>

  <script src="app.js"></script>
  <script>
    // optional: set Open button href whenever result is shown
    const shortUrlEl = document.getElementById("shortUrl");
    const openBtn = document.getElementById("openBtn");
    const obs = new MutationObserver(() => {
      if (shortUrlEl && openBtn && shortUrlEl.value) openBtn.href = shortUrlEl.value;
    });
    obs.observe(document.getElementById("result"), { attributes: true, attributeFilter: ["class"] });
  </script>
</body>
</html>
